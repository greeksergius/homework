# Домашнее задание к занятию 12.4 "Реляционные базы данных: SQL. Часть 2"
# Выполнил: Григорьев Сергей. 

---

Задание можно выполнить как в любом IDE, так и в командной строке.

### Задание 1.
---

Одним запросом получите информацию о магазине, в котором обслуживается более 300 покупателей и выведите в результат следующую информацию: 
- фамилия и имя сотрудника из этого магазина,
- город нахождения магазина,
- количество пользователей, закрепленных в этом магазине.


#### ОТВЕТ

> ЗАПРОС:
```
select s.store_id, s. manager_staff_id, s. address_id, CONCAT (s2.first_name, ' ',s2. last_name) as fio_manager, c.city_id, c. city, c2. store_id, count(c2.customer_id) from store s join staff s2 join address a join city c 
join customer c2  where s.manager_staff_id = s2.staff_id and s. address_id = a.address_id  and a. city_id = c. city_id  and c2.store_id = s.store_id group by c2.store_id , s.manager_staff_id ;
```
![Alt text](https://github.com/greeksergius/homework/blob/main/12-3%20SQL%20p1/2022-10-14_22-39-52.png)


### Задание 2.
---

Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.

### Задание 3.
---

Получите информацию, за какой месяц была получена наибольшая сумма платежей и добавьте информацию по количеству аренд за этот месяц.


## Дополнительные задания (со звездочкой*)
---
Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.


### Задание 4*.

Посчитайте количество продаж, выполненных каждым продавцом. Добавьте вычисляемую колонку «Премия». Если количество продаж превышает 8000, то значение в колонке будет «Да», 
иначе должно быть значение «Нет».

### Задание 5*.

Найдите фильмы, которые ни разу не брали в аренду.
